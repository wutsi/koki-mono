<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<body>

<div th:fragment="listing-status-badge(listing)" th:remove="tag">
    <span class="listing-status badge"
          th:classappend="${listing.statusSold} ? 'text-bg-danger' : 'text-bg-primary'"
          th:text="#{'listing-status.' + ${listing.status}} + ' ' + ${listing.soldAtText}"
    >STATUS</span>
</div>

<div class="listing-carousel" th:fragment="listing-carousel(listings, showSummary)">
    <div th:each="listing : ${listings}" th:remove="tag">
        <div th:replace="~{__components/listing :: listing-card(${listing}, ${showSummary})}"></div>
    </div>
</div>

<div class="listing-card" th:data-id="${listing.id}" th:fragment="listing-card(listing, showSummary)">
    <a th:href="${listing.publicUrl}">
        <div class="listing-status-container">
            <div th:if="${listing.statusSold}" th:remove="tag">
                <div th:replace="~{__components/listing :: listing-status-badge(${listing})}"></div>
            </div>
        </div>
        <div class="hero-image-container flex flex-center">
            <img class="hero-image" th:alt="${listing.title}"
                 th:src="${listing.heroImageUrl} ? ${listing.heroImageUrl} : '/image/no-image.png'"
                 th:title="${listing.title}"
            />
        </div>
    </a>
    <div class="listing-details padding-small">
        <a th:href="${listing.publicUrl}">
            <b class="listing-price" th:if="!${listing.statusSold}" th:text="${listing.price.displayText}">$$$</b>

            <div class="text-small flex">
                <div th:if="!${listing.propertyTypeResidential}"
                     th:text="#{'property-type.' + ${listing.propertyType}}">
                    APARTMENT
                </div>
                <div class="padding-left-small" th:if="!${listing.propertyTypeResidential}">-</div>
                <div th:replace="~{__components/listing :: listing-bed-bath-area(${listing})}"></div>
            </div>

            <div class="text-small address margin-top" th:text="${listing.address.street}">STREET</div>
            <div class="text-small address" th:if="${listing.address}">
                <span th:text="${listing.address?.neighbourhood?.name}">XXX</span>
                <span th:if="${listing.address?.neighbourhood} AND ${listing.address?.city}">-</span>
                <span th:text="${listing.address?.city?.name}">XXX</span>
            </div>

            <div class="margin-top text-small summary" th:if="${showSummary} AND ${listing.summary}"
                 th:text="${listing.summary}">SUMMARY
            </div>
        </a>
    </div>
</div>

<div class="flex" th:fragment="listing-bed-bath-area(listing)">
    <div th:if="${listing.bedrooms}">
        <span th:text="${listing.bedrooms}">00</span>
        <span th:text="#{page.listing.bedrooms-short}">BED</span>
    </div>
    <div class="padding-left-small" th:if="${listing.bedrooms} AND ${listing.bathrooms}">-</div>
    <div class="padding-left-small" th:if="${listing.bathrooms}">
        <span th:text="${listing.bathrooms}">00</span>
        <span th:text="#{page.listing.bathrooms-short}">BATH</span>
    </div>
    <div class="padding-left-small"
         th:if="(${listing.bedrooms} OR ${listing.bathrooms}) AND (${listing.lotArea} OR ${listing.propertyArea})">
        -
    </div>
    <div class="padding-left-small" th:if="${listing.lotArea} OR ${listing.propertyArea}">
        <span th:if="${listing.lotArea}" th:text="${listing.lotArea}">00</span>
        <span th:if="!${listing.lotArea}" th:text="${listing.propertyArea}">00</span>
        m<sup>2</sup>
    </div>
</div>

<div th:fragment="listing-price-trend(saleMetrics, rentalMetrics, landMetrics)">
    <table class="table table-striped" th:if="${saleMetrics}">
        <tr>
            <th colspan="2" th:text="#{page.listing.metric.section.residential.sale}">Residential - Sales</th>
        </tr>
        <tr th:if="${saleMetrics}">
            <td th:text="#{page.listing.metric.median_price}">Median Sale Price</td>
            <td class="text-right">
                <b th:text="${saleMetrics.averagePrice.shortText}">$$$</b>
            </td>
        </tr>
        <tr th:each="metric : ${salesMetricsPerRoom}" th:if="${metric.bedrooms}">
            <td th:if="${metric.bedrooms == 1}" th:text="#{page.listing.metric.median_price_1_bedroom}">
                Bedroom Sale Price
            </td>
            <td th:if="${metric.bedrooms > 1}"
                th:text="#{page.listing.metric.median_price_n_bedroom(${metric.bedrooms})}">
                Bedroom Sale Price
            </td>
            <td class="text-right">
                <b th:text="${metric.averagePrice.shortText}">$$$</b>
            </td>
        </tr>
    </table>

    <table class="table table-striped" th:if="${rentalMetrics}">
        <tr>
            <th colspan="2" th:text="#{page.listing.metric.section.residential.rental}">Residential - Rentals</th>
        </tr>
        <tr th:if="${rentalMetrics}">
            <td th:text="#{page.listing.metric.median_price}">Median Rental Price</td>
            <td class="text-right">
                <b th:text="${rentalMetrics.averagePrice.shortText}">$$$</b>
            </td>
        </tr>
        <tr th:each="metric : ${rentalMetricsPerRoom}" th:if="${metric.bedrooms}">
            <td th:if="${metric.bedrooms == 1}" th:text="#{page.listing.metric.median_price_1_bedroom}">
                Bedroom Sale Price
            </td>
            <td th:if="${metric.bedrooms > 1}"
                th:text="#{page.listing.metric.median_price_n_bedroom(${metric.bedrooms})}">
                Bedroom Sale Price
            </td>
            <td class="text-right">
                <b th:text="${metric.averagePrice.shortText}">$$$</b>
            </td>
        </tr>
    </table>

    <table class="table table-striped" th:if="${landMetrics}">
        <tr>
            <th colspan="2" th:text="#{page.listing.metric.section.land}">Land</th>
        </tr>
        <tr>
            <td th:text="#{page.listing.metric.median_price}">Median Sale Price</td>
            <td class="text-right">
                <b th:text="${landMetrics.averagePrice.shortText}">$$$</b>
            </td>
        </tr>
        <tr th:if="${landMetrics?.pricePerSquareMeter}">
            <td th:utext="#{page.listing.metric.median_price_per_m2}">Price per m<sup>2</sup></td>
            <td class="text-right">
                <b th:text="${landMetrics.pricePerSquareMeter.shortText}">$$$</b>
            </td>
        </tr>
    </table>
</div>

<div th:fragment="listing-price-metrics(saleMetrics, rentalMetrics, landMetrics)">
    <table class="w-100">
        <tr th:if="${saleMetrics}">
            <td class="text-center">
                <span th:text="#{page.listing.metric.for_sale}">FOR_SALE</span>:
                <b class="margin-right-small" th:text="${saleMetrics.total}">000</b>
            </td>
            <td class="text-center">
                <span th:text="#{page.listing.metric.median_price}">AVERAGE PRICE</span>:
                <b class="margin-right-small" th:text="${saleMetrics.averagePrice.shortText}">$$$</b>
            </td>
        </tr>
        <tr th:if="${rentalMetrics}">
            <td class="text-center">
                <span th:text="#{page.listing.metric.for_rental}">RENTAL</span>:
                <b class="margin-right-small" th:text="${rentalMetrics.total}">000</b>
            </td>
            <td class="text-center">
                <span th:utext="#{page.listing.metric.median_price}">AVERAGE PRICE</span>:
                <b class="margin-right-small"
                   th:text="${rentalMetrics.averagePrice.shortText}">$$$</b>
            </td>
        </tr>
        <tr th:if="${landMetrics}">
            <td class="text-center">
                <span th:text="#{page.listing.metric.section.land}">LAND</span>:
                <b class="margin-right-small" th:text="${rentalMetrics.total}">000</b>
            </td>
            <td class="text-center">
                <span th:utext="#{page.listing.metric.median_price_per_m2}">PRICE_PER_M2</span>:
                <b class="margin-right-small"
                   th:text="${landMetrics.pricePerSquareMeter.shortText}">$$$</b>
            </td>
        </tr>
    </table>
</div>

</body>
</html>
